<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Text?>
<?import javafx.geometry.Insets?>

<StackPane xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1" 
           fx:controller="com.group25.greengrocer.controller.CarrierController"
           prefWidth="960" prefHeight="540">
    
    <!-- Main Carrier Panel -->
    <BorderPane stylesheets="@../css/app.css">
        
        <!-- Header -->
        <top>
            <HBox spacing="20" alignment="CENTER_LEFT" styleClass="carrier-header">
                <Text fx:id="welcomeText" text="Welcome, Carrier" styleClass="welcome-text"/>
                <Label fx:id="ratingLabel" text="Rating: -/5" style="-fx-font-size: 14px; -fx-text-fill: #f1c40f; -fx-font-weight: bold;"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Button text="Refresh All" onAction="#handleRefreshAll" styleClass="refresh-btn"/>
                <Button text="Profile" onAction="#handleShowProfile" styleClass="profile-btn"/>
                <Button text="Logout" onAction="#handleLogout" styleClass="logout-btn"/>
            </HBox>
        </top>
        
        <!-- Main Content - 3 Sections -->
        <center>
            <VBox spacing="15" style="-fx-padding: 20; -fx-background-color: #f5f5f5;">
                
                <!-- Available Orders Section -->
                <VBox spacing="10" VBox.vgrow="ALWAYS">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <Text text="Available Orders" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-fill: #333;"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button text="Refresh" onAction="#handleRefreshAvailable" styleClass="button-secondary" style="-fx-font-size: 12px; -fx-padding: 5 15;"/>
                    </HBox>
                    
                    <TableView fx:id="availableOrdersTable" VBox.vgrow="ALWAYS" style="-fx-background-color: white;">
                        <columns>
                            <TableColumn fx:id="availOrderIdCol" text="Order ID" prefWidth="80"/>
                            <TableColumn fx:id="availCustomerNameCol" text="Customer Name" prefWidth="150"/>
                            <TableColumn fx:id="availCustomerAddressCol" text="Customer Address" prefWidth="200"/>
                            <TableColumn fx:id="availDeliveryDateCol" text="Delivery Date" prefWidth="130"/>
                            <TableColumn fx:id="availTotalCol" text="Total ($)" prefWidth="100"/>
                            <TableColumn fx:id="availActionsCol" text="Actions" prefWidth="150"/>
                        </columns>
                        <placeholder>
                            <Label text="No available orders." style="-fx-text-fill: #999;"/>
                        </placeholder>
                    </TableView>
                </VBox>
                
                <!-- Current Orders Section -->
                <VBox spacing="10" VBox.vgrow="ALWAYS">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <Text text="Current Orders" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-fill: #333;"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button text="Refresh" onAction="#handleRefreshCurrent" styleClass="button-secondary" style="-fx-font-size: 12px; -fx-padding: 5 15;"/>
                    </HBox>
                    
                    <TableView fx:id="currentOrdersTable" VBox.vgrow="ALWAYS" style="-fx-background-color: white;">
                        <columns>
                            <TableColumn fx:id="currOrderIdCol" text="Order ID" prefWidth="80"/>
                            <TableColumn fx:id="currCustomerNameCol" text="Customer Name" prefWidth="150"/>
                            <TableColumn fx:id="currCustomerAddressCol" text="Customer Address" prefWidth="200"/>
                            <TableColumn fx:id="currDeliveryDateCol" text="Delivery Date" prefWidth="130"/>
                            <TableColumn fx:id="currTotalCol" text="Total ($)" prefWidth="100"/>
                            <TableColumn fx:id="currActionsCol" text="Actions" prefWidth="150"/>
                        </columns>
                        <placeholder>
                            <Label text="No current orders." style="-fx-text-fill: #999;"/>
                        </placeholder>
                    </TableView>
                </VBox>
                
                <!-- Completed Orders Section -->
                <VBox spacing="10" VBox.vgrow="ALWAYS">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <Text text="Completed Orders" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-fill: #333;"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button text="Refresh" onAction="#handleRefreshCompleted" styleClass="button-secondary" style="-fx-font-size: 12px; -fx-padding: 5 15;"/>
                    </HBox>
                    
                    <TableView fx:id="completedOrdersTable" VBox.vgrow="ALWAYS" style="-fx-background-color: white;">
                        <columns>
                            <TableColumn fx:id="compOrderIdCol" text="Order ID" prefWidth="80"/>
                            <TableColumn fx:id="compCustomerNameCol" text="Customer Name" prefWidth="150"/>
                            <TableColumn fx:id="compRequestedDateCol" text="Requested Date" prefWidth="130"/>
                            <TableColumn fx:id="compDeliveredDateCol" text="Delivered Date" prefWidth="130"/>
                            <TableColumn fx:id="compRatingCol" text="Rating" prefWidth="60"/>
                            <TableColumn fx:id="compTotalCol" text="Total ($)" prefWidth="100"/>
                            <TableColumn fx:id="compActionsCol" text="Actions" prefWidth="120"/>
                        </columns>
                        <placeholder>
                            <Label text="No completed orders." style="-fx-text-fill: #999;"/>
                        </placeholder>
                    </TableView>
                </VBox>
                
            </VBox>
        </center>
        
    </BorderPane>

    <!-- Order Details Popup (Hidden by default) -->
    <VBox fx:id="orderDetailsPopup" visible="false" managed="false" 
          spacing="15" style="-fx-padding: 25; -fx-background-color: white; -fx-border-color: #2c3e50; -fx-border-width: 2; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.4), 15, 0, 0, 0);"
          maxWidth="600" maxHeight="500" alignment="CENTER">
        
        <Label fx:id="orderDetailsTitleLabel" text="Order Details" style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
        
        <TableView fx:id="orderDetailsTable" VBox.vgrow="ALWAYS">
            <columns>
                <TableColumn fx:id="detailProductNameCol" text="Product" prefWidth="200"/>
                <TableColumn fx:id="detailQuantityCol" text="Qty" prefWidth="80"/>
                <TableColumn fx:id="detailUnitCol" text="Unit" prefWidth="80"/>
                <TableColumn fx:id="detailUnitPriceCol" text="Price" prefWidth="80"/>
                <TableColumn fx:id="detailLineTotalCol" text="Total" prefWidth="80"/>
            </columns>
            <placeholder>
                <Label text="No products in this order."/>
            </placeholder>
        </TableView>

        <HBox spacing="20" alignment="CENTER_RIGHT">
            <Label text="Total Amount:" style="-fx-font-weight: bold; -fx-font-size: 14px;"/>
            <Label fx:id="orderDetailsTotalLabel" text="\$0.00" style="-fx-font-weight: bold; -fx-font-size: 16px; -fx-text-fill: #e74c3c;"/>
        </HBox>

        <Button text="Close" onAction="#handleCloseOrderDetails"
                style="-fx-background-color: #95a5a6; -fx-text-fill: white; -fx-font-weight: bold; -fx-padding: 8 20;"/>
    </VBox>
    
</StackPane>
